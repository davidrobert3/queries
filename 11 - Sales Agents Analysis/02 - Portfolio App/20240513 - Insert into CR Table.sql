INSERT INTO public.collection_rate (
    last_refresh_date,
    region,
    shop,
    unique_account_id,
    customer_name,
    customer_phone_1,
    customer_phone_2,
    ward,
    location_customer_met_latitude,
    location_customer_met_longitude,
    esf_only_status,
    sales_agent_name,
    agent_id,
    agent_status,
    last_7_day_cr,
    technician_name,
    daily_rate,
    consecutive_late_days,
    sales_agent_mobile,
    six_month_collection_rate,
    installation_date,
    cash_collected,
    days_expected,
    customer_age_tag,
    total_expected_cash,
    par_0_29,
    par_30_59,
    par_60_119,
    par_120,
    customersegment,
    eligible
)
SELECT
    pb.last_refresh_date,
    pb.region,
    pb.shop,
    pb.unique_account_id,
    pb.customer_name,
    pb.customer_phone_1,
    pb.customer_phone_2,
    pb.ward,
    pb.location_customer_met_latitude,
    pb.location_customer_met_longitude,
    pb.esf_only_status,
    pb.sales_agent_name,
    pb.agent_id,
    pb.agent_status,
    pb.last_7_day_cr,
    pb.technician_name,
    pb.daily_rate,
    pb.consecutive_late_days,
    pb.sales_agent_mobile,
    pb.six_month_collection_rate,
    pb.installation_date,
    pb.cash_collected,
    pb.days_expected,
    pb.customer_age_tag,
    pb.total_expected_cash,
    pb.par_0_29,
    pb.par_30_59,
    pb.par_60_119,
    pb.par_120,
    pb.customersegment,
    pb.eligible
FROM public.pb_agents AS pb
WHERE pb.unique_account_id NOT IN (
    SELECT unique_account_id
    FROM public.collection_rate
    where unique_account_id notnull 
);
