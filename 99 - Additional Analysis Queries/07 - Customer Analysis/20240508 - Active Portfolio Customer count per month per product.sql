select 
	distinct last_.date_timestamp as last_day_of_the_month,
	case trim(rrs.product_name)
When 'Mwanzo 3BT 18M V1.03.2023' Then 'Bpower Lights'
When 'Upgrade of Radio v3.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade of Torch v3.03.2023' Then 'other Appliances Upgrade'
When '21M Mdosi 4BRT JUN22' Then 'Bpower Lights'
When '21M Mdosi 5BR JUN22' Then 'Bpower Lights'
When '21M Mdosi 5BT JUN22' Then 'Bpower Lights'
When '21M Mdosi TV24 4BR JUN22' Then 'TV sales'
When '21M Mdosi TV24 4BR v3.03.2023' Then 'TV sales'
When '21M Mdosi TV24 4BT JUN22' Then 'TV sales'
When '21M Mdosi TV24 4BT v3.03.2023' Then 'TV sales'
When '21M Mdosi TV24 5B JUN22' Then 'TV sales'
When '21M Mdosi TV32 3BR NOV21' Then 'TV sales'
When '21M Mdosi TV32 3BT NOV21' Then 'TV sales'
When '21M Mdosi TV32 4BR JUN22' Then 'TV sales'
When '21M Mdosi TV32 4BR v3.03.2023' Then 'TV sales'
When '21M Mdosi TV32 4BT JUN22' Then 'TV sales'
When '21M Mdosi TV32 4BT v3.03.2023' Then 'TV sales'
When '21M Mdosi TV32 5B JUN22' Then 'TV sales'
When '21M Optimised 24" TV with Aerial' Then 'Tv sales'
When '21M SureChill Fridge OCT22' Then 'Surechill'
When '24" TV Screen Repair OCT22 (in warranty)' Then 'Repair/Maintenance'
When '24" TV Screen Repair OCT22out of warraty' Then 'TV upgrade'
When '24" TV V2 with Aerial + Lithium Battery' Then 'TV upgrade'
When '24" TV V2 with Aerial NOV21' Then 'TV upgrade'
When '24" TV V2 with Aerial v3.03.2023' Then 'TV upgrade'
When '24″ TV V2 with Aerial' Then 'TV upgrade'
When '32" TV Screen Repair OCT22 (in warranty)' Then 'Repair/Maintenance'
When '32" TV with Aerial + Lithium Battery' Then 'TV upgrade'
When '36M Optimised 24" TV with Aerial' Then 'Tv sales'
When '36M Optimised 24" TV with Aerial v3.03.2023' Then 'TV sales'
When 'Bboxx Faida (bP50 Lights)' Then 'faida'
When 'BBOXX Faida TV' Then 'faida'
When 'Bboxx Subwoofer with PVC leather' Then 'other Appliances Upgrade'
When 'bPower50 TV Maintenance' Then 'Repair/Maintenance'
When 'Cash Optimised 24" TV with Aerial v3.03.2023' Then 'TV sales'
When 'Chap Chap Mdosi 4BRT MAY21' Then 'Bpower Lights'
When 'Chap Chap Mdosi 4BRT OCT21' Then 'Bpower Lights'
When 'Chap Chap Mdosi 5BT MAY21' Then 'Bpower Lights'
When 'Chap Chap Mdosi TV 4BR_JUL21' Then 'TV sales'
When 'Chap Chap Mdosi TV32 3BR OCT21' Then 'TV sales'
When 'Chap Chap Mdosi TV32 3BT OCT21' Then 'TV sales'
When 'Chap Chap TV 4BR' Then 'TV sales'
When 'DC Radio (V4)' Then 'other Appliances Upgrade'
When 'DC Radio (V4.1)' Then 'other Appliances Upgrade'
When 'DC Shaver' Then 'other Appliances Upgrade'
When 'Discounted bP20 to Lithium battery + 24" TV v1.03.2023' Then 'TV upgrade'
When 'Discounted CU Lithium 9.9Ah Upgrade v1.03.2023' Then 'other Appliances Upgrade'
When 'Discounted Fan upgrade v3.03.2023' Then 'other Appliances Upgrade'
When 'Discounted shaver OCT21' Then 'other Appliances Upgrade'
When 'Discounted subwoofer OCT21' Then 'other Appliances Upgrade'
When 'Discounted Sub-woofer upgrade v3.03.2023' Then 'other Appliances Upgrade'
When 'Discounted TV 24" with Aerial + Lithium Battery' Then 'TV upgrade'
When 'Discounted TV 24" with Aerial + Lithium Battery v3.03.2023' Then 'TV upgrade'
When 'Discounted TV 24" with Aerial OCT21' Then 'TV upgrade'
When 'Discounted TV 32" with Aerial + Lithium Battery' Then 'TV upgrade'
When 'Discounted TV 32" with Aerial + Lithium Battery v3.03.2023' Then 'TV upgrade'
When 'Discounted TV 32" with Aerial OCT21' Then 'TV upgrade'
When 'Energy Service Fee V0' Then 'faida'
When 'Faida Chap Chap' Then 'faida'
When 'Fan Upgrade' Then 'other Appliances Upgrade'
When 'Flexx10 Cash V3.03.2023' Then 'Flexx 10'
When 'Flexx40 13M 3B v2.11.2022' Then 'Flexx 40'
When 'Flexx40 13M 3BR v2.11.2022' Then 'Flexx 40'
When 'Flexx40 21M 3B v2.11.2022' Then 'Flexx 40'
When 'Flexx40 21M 3B V3.03.2023' Then 'Flexx 40'
When 'Flexx40 21M 3BR v2.11.2022' Then 'Flexx 40'
When 'Flexx40 21M 3BR v3.03.2023' Then 'Flexx 40'
When 'Flexx40 3B 13M v1.112022 (To be signed up at CSCC)' Then 'Flexx 40'
When 'Flexx40 3B 21M v1.112022 (To be signed up at CSCC)' Then 'Flexx 40'
When 'Flexx40 3B cash v1.11.2022' Then 'Flexx 40'
When 'Flexx40 3B Cash V2.03.2023' Then 'Flexx 40'
When 'Flexx40 3B v3.03.2023' Then 'Flexx 40'
When 'Flexx40 3BR 13M v1.112022 (To be signed up at CSCC)' Then 'Flexx 40'
When 'Flexx40 3BR 21M v1.112022 (To be signed up at CSCC)' Then 'Flexx 40'
When 'Flexx40 3BR cash v1.11.2022' Then 'Flexx 40'
When 'Flexx40 3BR v3.03.2023' Then 'Flexx 40'
When 'LED Bulb Set' Then 'other Appliances Upgrade'
When 'Light bulb upgrade v3.03.2023' Then 'other Appliances Upgrade'
When 'LPG discounted 36 Months' Then 'other Appliances Upgrade'
When 'LPG Upgrade 18 OCT21' Then 'other Appliances Upgrade'
When 'Mdosi 4BRT v3.03.2023' Then 'Bpower Lights'
When 'Mdosi 5BR v3.03.2023' Then 'Bpower Lights'
When 'Mdosi 5BT v3.03.2023' Then 'Bpower Lights'
When 'Mdosi Cash 4BRT JUN22' Then 'Bpower Lights'
When 'Mdosi Cash 4BRT v3.03.2023' Then 'Bpower Lights'
When 'Mdosi Cash 5BR JUN22' Then 'Bpower Lights'
When 'Mdosi Cash TV24 4BR JUN22' Then 'TV sales'
When 'Mdosi Lights Radio' Then 'Bpower Lights'
When 'Mdosi Lights RT' Then 'Bpower Lights'
When 'Mdosi TV 24" 4BR v3.03.2023' Then 'TV sales'
When 'Mdosi TV 24" 4BT v3.03.2023' Then 'TV sales'
When 'Mdosi TV 24" 5B v3.03.2023' Then 'Tv sales'
When 'Mdosi TV 32" 4BR V3.03.2023' Then 'TV sales'
When 'Mdosi TV 32" 4BT V3.03.2023' Then 'TV sales'
When 'Mdosi TV 32" 5B v3.03.2023' Then 'TV sales'
When 'Mdosi TV Radio' Then 'TV sales'
When 'Mdosi TV Torch' Then 'TV sales'
When 'Mwanzo 3BR 18M JUN22' Then 'Bpower Lights'
When 'Mwanzo 3BR 18M v1.03.2023' Then 'Bpower Lights'
When 'Mwanzo 3BT 18M JUN22' Then 'Bpower Lights'
When 'Mwanzo 4B 18M JUN22' Then 'Bpower Lights'
When 'Mwanzo Cash 3BT JUN22' Then 'Bpower Lights'
When 'Optimised 24" TV with Aerial v3.03.2023' Then 'TV sales'
When 'Other 24" TV Repair OCT22 out of warraty' Then 'Repair/Maintenance'
When 'OtherCU-BatteryRepair OCT22out of waraty' Then 'Repair/Maintenance'
When 'Promo 24” TV V2 with Aerial_JUL21' Then 'TV upgrade'
When 'Promo Flexx10 Cash JUN22' Then 'Flexx 40'
When 'Promo Flexx40 Lights APR22' Then 'Flexx 40'
When 'Promo Flexx40 Radio JUN22' Then 'Flexx 40'
When 'Repair CU OCT21' Then 'Repair/Maintenance'
When 'Repair Radio V4 OCT21' Then 'Repair/Maintenance'
When 'Shaver Repair OCT22 (in warranty' Then 'Repair/Maintenance'
When 'Shaver Repair OCT22 (in warranty)' Then 'Repair/Maintenance'
When 'Shaver Repair OCT22 (out of warranty)' Then 'Repair/Maintenance'
When 'Solar panel 50W upgrade' Then 'other Appliances Upgrade'
When 'SPHN_Discounted Samsung A13 v1.03.2023' Then 'Connect'
When 'SPHN_SAgent_Samsung A03 Core' Then 'Connect'
When 'SPHN_Samsung A03 Core' Then 'Connect'
When 'SPHN_Samsung A03 Core bundled Offer v1.12.22' Then 'Connect'
When 'SPHN_Samsung A03 Core v1.03.2023_test' Then 'Connect'
When 'SPHN_Samsung A03 Core v3.10.2022' Then 'Connect'
When 'SPHN_Samsung A13 bundled Offer v1.12.22' Then 'Connect'
When 'SPHN_Samsung A13 v3.10.2022' Then 'Connect'
When 'SPHN_Samsung A14 v1.07.2023' Then 'Connect'
When 'StarTimes Nova with Subscription' Then 'other Appliances Upgrade'
When 'StarTimes Nova with Subscription v2.03.2023' Then 'other Appliances Upgrade'
When 'SureChill Fridge v3.03.2023' Then 'Surechill'
When 'Taa Imara 5BR – High DP Pilot (Kakuma & Isiolo)' Then 'Taa Imara'
When 'Taa Imara 5BR - Low DP Pilot (Kibwezi & Wote)' Then 'Taa Imara'
When 'Taa Imara 5BR v1.03.2023' Then 'Taa Imara'
When 'Taa Imara 5BT – High DP Pilot (Kakuma & Isiolo)' Then 'Taa Imara'
When 'Taa Imara 5BT – Low DP Pilot (Kibwezi & Wote)' Then 'Taa Imara'
When 'Taa Imara 5BT v1.03.2023' Then 'Taa Imara'
When 'Torch' Then 'other Appliances Upgrade'
When 'Torch V3' Then 'other Appliances Upgrade'
When 'TV 15'''' with Aerial' Then 'Faida'
When 'TV 24'''' with Aerial' Then 'TV upgrade'
When 'TV 24" with Aerial + Lithium Battery V2.03.2023' Then 'TV upgrade'
When 'TV 32" with Aerial + Lithium Battery v2.03.2023' Then 'TV upgrade'
When 'Unilever Retailer' Then 'other Appliances Upgrade'
When 'Upfront Multiple USB Charger Repair OCT22' Then 'Repair/Maintenance'
When 'Upgrade Fan v3.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Light bulb set' Then 'other Appliances Upgrade'
When 'Upgrade of Radio' Then 'other Appliances Upgrade'
When 'Upgrade Power Bank 10000mAh' Then 'other Appliances Upgrade'
When 'Upgrade Shaver v2.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Shaver v3.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Subwoofer' Then 'other Appliances Upgrade'
When 'Upgrade Subwoofer V1.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Subwoofer  V1.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Torch' Then 'other Appliances Upgrade'
When 'Welcome Pack V1' Then 'faida'
When 'Welcome Pack V2 Bulb' Then 'faida'
When 'Welcome Pack V2 Radio V3' Then 'faida'
When 'Welcome Pack V2 Radio V4' Then 'faida'
When 'Welcome Pack V2 Torch' Then 'faida'
When 'ZUKU Satellite TV Kit with Subscription' Then 'other Appliances Upgrade'
When 'ZUKU Satellite TV Kit with Subscription v2.03.2023' Then 'other Appliances Upgrade'
When 'Upgrade Subwoofer V1.03.2023' Then 'Subwoofer'
When 'Upgrade Subwoofer V1.03.2023' Then 'other Appliances Upgrade'
When 'Flexx40 3BR v3.09.2023' Then 'Flexx 40'
When 'Flexx40 3B v3.09.2023' Then 'Flexx 40'
When 'Flexx40 3BR v3.09.2023' Then 'Bpower Lights'
When 'Flexx40 3B v3.09.2023' Then 'Bpower Lights'
When 'Mdosi TV 32" 4BT v3.09.2023' Then 'TV sales'
When '39” PAYGO TV v1.08.2023' Then 'TV sales'
When 'Taa Imara 5BT v1.09.2023' Then 'Taa Imara'
When 'Taa Imara 5BR v1.09.2023' Then 'Taa Imara'
When 'Mdosi TV 24" 4BR v3.09.2023' Then 'TV sales'
When 'SPHN_Samsung A14 v2.09.2023' Then 'Connect'
when 'Infinix Smart 7 HD 2+64GB' then 'Connect'
when 'Tecno Pop 7 Pro 4+64GB' then 'Connect'
When 'Chap Chap Mdosi 4BRT' Then 'Bpower Lights'
When 'Taa Imara 4BRT v1.09.2023' Then 'Taa Imara'
when 'Mdosi TV 32" 4BR v3.09.2023' then 'TV sales'
when 'Mdosi TV 24" 4BT v3.09.2023' then 'TV sales'
When 'Mdosi TV 24" 5B v3.09.2023' then 'TV sales'
When 'Mdosi TV 32" 5B v3.09.2023' then 'TV sales'
When 'bPower 160 TV 32" 4BR v1.10.2023' then 'TV sales'
When 'Mdosi TV 24" 4BR + Fan v3.09.2023' then 'TV sales'
When 'Flexx 12 v1.11.2023' then 'Flexx 12'
When 'Mwananchi TV 24" 4BT v1.10.2023' then 'TV sales'
When 'Sonko TV 39" 5B + Fan v1.10.2023' then 'TV sales'
when 'Tosha TV 32" 4BT v1.10.2023' then 'TV sales'
when 'Tosha TV 32" 4BR v1.10.2023' then 'TV sales'
when 'Tosha Upgrade TV 32" v1.11.2023' then 'TV upgrade'
when 'Tosha Upgrade TV 32" 4BR v1.11.2023' then 'TV upgrade'
When 'Tosha Upgrade TV 32" v1.11.2023' Then 'TV upgrade'
When 'Tosha Upgrade TV 32" 4BR  v1.11.2023' Then 'TV upgrade'
when 'Mwananchi TV 24" 4BR v1.10.2023' then 'TV sales'
when 'Mwananchi Upgrade TV 24" v1.11.2023' then 'TV upgrade'
when 'Power Bank 10000mAh' then 'other Appliances Upgrade'
when 'Samsung A14' then 'Connect'
when 'Samsung A14' then 'Connect'
when 'Samsung A03 Core' then 'Connect'
when '12W Solar Panel of Flexx40' then 'other Appliances Upgrade'
when 'bP60 to bPower120 + 24" TV upgrade v1.11.23' then 'TV upgrade'
when 'Sonko TV 39" 5B + Woofer v1.10.2023'then 'TV sales'
when 'CU Lithium 9.9Ah Upgrade V1.03.2023' then 'other Appliances Upgrade'
When 'Flexx40 3B v4.03.2024' Then 'Flexx 40'
When 'Flexx40 3BR v4.03.2024' Then 'Flexx 40'
When 'Taa Imara 4BRT v2.03.2024' Then 'Taa Imara'
When 'Discounted TV 24" with Aerial + CU Upgrade v3.03.2024' Then 'TV upgrade'
When 'Mdosi TV 24" 4BR v4.03.2024' Then 'TV sales'
When 'Mdosi TV 24" 4BT v4.03.2024' Then 'TV sales'
When 'Taa Imara 5BR v2.03.2024' Then 'Taa Imara'
When 'CU Lithium 9.9Ah Upgrade V2.03.2024' Then 'other Appliances Upgrade'
When 'Discounted TV 24" with Aerial + CU Upgrade v3.03.2024' Then 'TV upgrade'
When 'Flexx 12 v2.03.2024' Then 'Flexx 12'
When 'Flexx40 3B v4.03.2024' Then 'Flexx 40'
When 'Flexx40 3BR v4.03.2024' Then 'Flexx 40'
When 'Mdosi TV 24" 4BR v4.03.2024' Then 'TV sales'
When 'Mdosi TV 24" 4BT v4.03.2024' Then 'TV sales'
When 'Taa Imara 4BRT v2.03.2024' Then 'Taa Imara'
When 'Taa Imara 5BR v2.03.2024' Then 'Taa Imara'
When 'Taa Imara 5BT v2.03.2024' Then 'Taa Imara'
When 'TV 24" with Aerial + Lithium Battery V3.03.2024' Then 'TV upgrade'
end as product_package,
count(*)
from kenya.agg_dcs_last_day_of_month last_ 
left join kenya.rp_retail_sales rrs on
	last_.account_id = rrs.account_id 
where last_.customer_status like 'active'
group by 1, 2
order by last_.date_timestamp desc 
